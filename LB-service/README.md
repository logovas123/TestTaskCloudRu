# Load Balancer
## Запуск сервиса
1) В папке config лежит файл config.json . Это конфигурационный файл, в котором перечисляется список серверов, на которые будет проксироваться запрос и порт на котором запущен сервис. Заполните файл `своими данными`  согласно примеру:
    ```json
    {
        "port": "8080",
        "list_of_srvs": [
          "http://server1:8088",
          "http://server2:8088",
          "http://server3:8088",
          ...
        ]
    }
    ```
    Путь до config-файла передаётся как флаг коммандной строки при запуске сервиса. Вы можете создать файл в другом месте, но требуется поменять путь до конфига в env-файле(переменная CONFIG_PATH, файл в корне проекта). 
2) Запустите сервис
    ```
    make up
    ```
3) Complete!!!

Приложение запущено по адресу: `http://localhost:8080`. Предусмотрен только главный эндпоинт "/". Метод GET.
## Дополнительные инструменты:
- Завершение работы сервиса
    ```
    make down
    ```
- Запуск с пересборкой
    ```
    make restart
    ```
- Очистка Docker
    ```
    make clean
    ```
## Запуск сервиса с тремя тестовыми серверами
Для наглядности создал кейс с тремя тестовыми серверами. Каждые 10 секунд серверы будут писать в логах: какое количество запросов на них проксировалось. Вся реализация кейса находится в папке testbackends.
### Запуск кейса
1) Заполните config.json `точно такими же данными`:
    ```json
    {
        "port": "8080",
        "list_of_srvs": [
          "http://server1:8088",
          "http://server2:8088",
          "http://server3:8088",
        ]
    }
    ```
2) Запустите сервис:
    ```
    make run-with-servers
    ```
3) Можете запустить данную команду и убедиться, что запросы равномерно распределяются между серверами:
    ```
    ab -n 5000 -c 1000 http://localhost:8080/
    ```
## Пояснение к структуре проекта 
Структура проекта разделена на отдельные логические модули.
- internal/lbserver \
Главный сервер на который отправляем запрос.
- internal/serverPool \
Представляет собой объект который хранит список(пул) серверов. Здесь реализуется алгоритм балансировки.
- internal/srvNode \
Здесь логика для работы с одним сервером из пула.
